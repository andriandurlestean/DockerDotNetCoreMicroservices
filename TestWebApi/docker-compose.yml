version: '3.4'

services:
  app:
    build:
      context: ./TestWebApi
      dockerfile: Dockerfile
    environment:
    - ASPNETCORE_ENVIRONMENT=Development
    - ASPNETCORE_URLS=http://+:7000
    expose:
      - "7000"
    depends_on:
      - db
    networks:
      main:
        aliases:
          - app

  app2:
    build:
      context: ./TestWebApi2
      dockerfile: Dockerfile
    environment:
    - ASPNETCORE_ENVIRONMENT=Development
    - ASPNETCORE_URLS=http://+:7002
    expose:
      - "7002"
    networks:
      main:
        aliases:
          - app2

  proxy:
    build:
      context: ./nginx
      dockerfile: Dockerfile
    ports:
      - "9999:80"
    depends_on:
        - app
    networks:
      main:
        aliases:
          - proxy

  db:
    image: "microsoft/mssql-server-linux"
    environment:
        SA_PASSWORD: "QAZwsx123_longone"
        ACCEPT_EULA: "Y"
    ports:
      - "1433:1433"
    networks:
      main:
        aliases:
          - db

networks:
  main: